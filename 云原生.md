## Docker
### cgroup和namespace
**namespace 是用来做资源隔离, cgroup 是用来做资源限制。**
#### cgroup
CGroups用来限定一个进程的资源使用，由Linux 内核支持，可以限制和隔离Linux进程组 (process groups) 所使用的物理资源 ，比如cpu、内存、磁盘和网络IO。

#### namespace
namespace用来限定一个进程可见的资源，隔离PID(进程ID)、IPC、Network等系统资源。
在每一个namespace内部，每一个用户都拥有一个属于自己的init进程，pid = 1。  
父容器有两个子容器，父容器的命名空间里有两个进程，id分别为3和4, 映射到两个子命名空间后，分别成为其init进程，这样命名空间A和B的用户都认为自己独占整台服务器。
![image](https://user-images.githubusercontent.com/35059921/179401879-145dd2ce-c5bf-4ae8-8803-25fe5d62d8fb.png)  
查看namespace信息：
```
ll /proc/$$/ns
```

### 容器和镜像
![05829b9f34706649fe2c5e683c76b3f](https://user-images.githubusercontent.com/35059921/179188557-5f2bc422-840b-472d-81e9-99402836ebab.png)
#### 镜像
镜像（Image）就是一堆只读层（read-only layer）的统一视角。
#### 容器
容器（container）的定义和镜像（image）几乎一模一样，也是一堆层的统一视角，唯一区别在于容器的最上面那一层是可读可写的。
#### 运行态容器
一个运行态容器（running container）被定义为一个可读写的统一文件系统加上隔离的进程空间和包含其中的进程。下面这张图片展示了一个运行中的容器。  
![image](https://user-images.githubusercontent.com/35059921/179346136-a62a80e3-98e0-4704-82e2-ef06116574f2.png)  
### Docker Image 和 Docker Layer (层) 有什么不同？
Image ：一个 Docker Image 是由一系列 Docker 只读层（read-only Layer） 创建出来的。
Layer： 在 Dockerfile 配置文件中完成的一条配置指令，即表示一个 Docker 层（Layer）。
如下 Dockerfile 文件包含 4 条指令，每条指令创建一个层（Layer）。
```
FROM ubuntu:15.04
COPY . /app
RUN make /app
CMD python /app/app.py
```
### 基础命令
#### CMD和ENTRYPOINT
CMD指令为容器提供默认的执行命令；ENTRYPOINT 指令的目的也是为容器指定默认执行的任务。
如果镜像中既没有指定 CMD 也没有指定 ENTRYPOINT 那么在启动容器时会报错。组合使用ENTRYPOINT和CMD, ENTRYPOINT指定默认的运行命令, CMD指定默认的运行参数。
